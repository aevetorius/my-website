<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JSON –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, sans-serif;
            background-color: #f0f0f0;
            color: #333;
            line-height: 1.3;
            padding: 10px;
            max-width: 414px;
            margin: 0 auto;
            font-size: 14px;
        }
        
        .container {
            background: white;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        h1 {
            font-size: 20px;
            text-align: center;
            margin-bottom: 15px;
            color: #1d1d1f;
            font-weight: 600;
        }
        
        h2 {
            font-size: 16px;
            margin: 15px 0 10px;
            color: #1d1d1f;
            font-weight: 600;
        }
        
        .form-group {
            margin-bottom: 12px;
        }
        
        label {
            display: block;
            font-size: 13px;
            font-weight: 500;
            margin-bottom: 4px;
            color: #555;
        }
        
        input, textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
            background-color: #fafafa;
        }
        
        input:focus, textarea:focus {
            outline: none;
            border-color: #0071e3;
            background-color: white;
        }
        
        .product-form {
            background: #fafafa;
            border-radius: 6px;
            padding: 12px;
            margin: 12px 0;
            position: relative;
            border: 1px solid #eee;
        }
        
        .product-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .product-header h3 {
            font-size: 15px;
            font-weight: 600;
            color: #1d1d1f;
        }
        
        .btn {
            display: inline-block;
            padding: 10px;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            text-align: center;
            cursor: pointer;
            text-decoration: none;
            width: 100%;
            margin: 6px 0;
        }
        
        .btn-primary {
            background-color: #0071e3;
            color: white;
        }
        
        .btn-success {
            background-color: #34c759;
            color: white;
        }
        
        .btn-danger {
            background-color: #ff3b30;
            color: white;
            padding: 6px 10px;
            font-size: 12px;
            width: auto;
        }
        
        .btn-warning {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .remove-btn {
            position: absolute;
            top: 10px;
            right: 10px;
        }
        
        .json-output {
            width: 100%;
            height: 150px;
            font-family: monospace;
            font-size: 11px;
            background-color: #fafafa;
            border: 1px solid #ddd;
            border-radius: 6px;
            padding: 10px;
        }
        
        .action-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            margin: 15px 0;
        }
        
        .btn-full {
            grid-column: 1 / -1;
        }
        
        .file-input {
            font-size: 12px;
            padding: 5px;
        }
        
        .checkbox-group {
            display: flex;
            align-items: center;
        }
        
        .checkbox-group input[type="checkbox"] {
            width: auto;
            margin-right: 8px;
        }
        
        @media (max-width: 414px) {
            body {
                padding: 8px;
            }
            
            .container {
                padding: 12px;
            }
            
            h1 {
                font-size: 18px;
                margin-bottom: 12px;
            }
            
            .btn {
                padding: 12px;
                font-size: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>JSON –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä</h1>
        
        <button type="button" class="btn btn-warning" onclick="openPhotoroom()">
            ‚úÇÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ñ–æ—Ç–æ
        </button>
        
        <div class="form-group">
            <label for="storeId">ID:</label>
            <input type="number" id="storeId" value="6">
        </div>
        
        <div class="form-group">
            <label for="storeName">–ù–∞–∑–≤–∞–Ω–∏–µ:</label>
            <input type="text" id="storeName" value="Ozon">
        </div>
        
        <div class="form-group">
            <label>–õ–æ–≥–æ—Ç–∏–ø:</label>
            <input type="file" id="logoFile" accept=".png,.jpg,.jpeg,.svg,.gif,.mp4,.mp3" class="file-input">
            <input type="text" id="logo" placeholder="Base64 –∏–ª–∏ URL">
        </div>
        
        <div class="form-group">
            <label>–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ:</label>
            <input type="file" id="storeImageFile" accept=".png,.jpg,.jpeg,.svg,.gif,.mp4,.mp3" class="file-input">
            <input type="text" id="storeImage" placeholder="Base64 –∏–ª–∏ URL">
        </div>

        <h2>–ü—Ä–æ–¥—É–∫—Ç—ã</h2>
        <div id="productsContainer"></div>
        
        <button type="button" class="btn btn-primary" onclick="addProduct()">
            + –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–¥—É–∫—Ç
        </button>
        
        <div class="action-buttons">
            <button type="button" class="btn btn-primary" onclick="generateJSON()">
                üìÑ –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å
            </button>
            <button type="button" class="btn btn-success" onclick="copyJSON()">
                üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
            </button>
        </div>
        
        <div class="form-group">
            <label for="jsonOutput">–†–µ–∑—É–ª—å—Ç–∞—Ç:</label>
            <textarea id="jsonOutput" class="json-output" readonly placeholder="JSON"></textarea>
        </div>
    </div>

    <script>
        let productCount = 0;

        function openPhotoroom() {
            window.open('https://www.photoroom.com/tools/background-remover', '_blank');
        }

        function addProduct() {
            const container = document.getElementById('productsContainer');
            const productDiv = document.createElement('div');
            productDiv.className = 'product-form';
            productDiv.innerHTML = `
                <div class="product-header">
                    <h3>–ü—Ä–æ–¥—É–∫—Ç ${productCount + 1}</h3>
                    <button type="button" class="btn btn-danger remove-btn" onclick="removeProduct(this)">
                        ‚úï
                    </button>
                </div>
                
                <div class="form-group">
                    <label>ID:</label>
                    <input type="number" class="productId" value="${productCount}" min="0">
                </div>
                
                <div class="form-group">
                    <label>–ù–∞–∑–≤–∞–Ω–∏–µ:</label>
                    <input type="text" class="productName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ">
                </div>
                
                <div class="form-group">
                    <label>–¶–µ–Ω–∞:</label>
                    <input type="text" class="productPrice" placeholder="78 ‚ÇΩ">
                </div>
                
                <div class="form-group">
                    <label>–í–µ—Å:</label>
                    <input type="text" class="productWeight" placeholder="80 –≥">
                </div>
                
                <div class="form-group">
                    <label>–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ:</label>
                    <input type="file" class="productImageFile" accept=".png,.jpg,.jpeg,.svg,.gif,.mp4,.mp3" class="file-input">
                    <input type="text" class="productImage" placeholder="Base64 –∏–ª–∏ URL">
                </div>
                
                <div class="form-group">
                    <label>–°—Å—ã–ª–∫–∞:</label>
                    <input type="url" class="productLink" placeholder="https://...">
                </div>
                
                <div class="form-group">
                    <label>–¢–µ–≥–∏:</label>
                    <input type="text" class="productTags" placeholder="—Ç–µ–≥1, —Ç–µ–≥2">
                </div>
                
                <div class="form-group">
                    <div class="checkbox-group">
                        <input type="checkbox" class="productIsMain">
                        <label>–û—Å–Ω–æ–≤–Ω–æ–π</label>
                    </div>
                </div>
            `;
            container.appendChild(productDiv);
            productCount++;
        }

        function removeProduct(button) {
            button.parentElement.parentElement.remove();
            productCount--;
            updateProductNumbers();
        }

        function updateProductNumbers() {
            const products = document.querySelectorAll('.product-form');
            products.forEach((product, index) => {
                const header = product.querySelector('.product-header h3');
                const idInput = product.querySelector('.productId');
                
                header.textContent = `–ü—Ä–æ–¥—É–∫—Ç ${index + 1}`;
                idInput.value = index;
            });
        }

        function fileToBase64(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.readAsDataURL(file);
                reader.onload = () => resolve(reader.result);
                reader.onerror = error => reject(error);
            });
        }

        async function processFileInputs() {
            const logoFile = document.getElementById('logoFile').files[0];
            if (logoFile) {
                const base64 = await fileToBase64(logoFile);
                document.getElementById('logo').value = base64;
            }

            const storeImageFile = document.getElementById('storeImageFile').files[0];
            if (storeImageFile) {
                const base64 = await fileToBase64(storeImageFile);
                document.getElementById('storeImage').value = base64;
            }

            const productImageFiles = document.querySelectorAll('.productImageFile');
            for (let i = 0; i < productImageFiles.length; i++) {
                const file = productImageFiles[i].files[0];
                if (file) {
                    const base64 = await fileToBase64(file);
                    productImageFiles[i].nextElementSibling.value = base64;
                }
            }
        }

        async function generateJSON() {
            await processFileInputs();

            const products = [];
            const productForms = document.querySelectorAll('.product-form');
            
            productForms.forEach(form => {
                const id = parseInt(form.querySelector('.productId').value) || 0;
                const name = form.querySelector('.productName').value;
                const price = form.querySelector('.productPrice').value;
                const weight = form.querySelector('.productWeight').value;
                const image = form.querySelector('.productImage').value;
                const link = form.querySelector('.productLink').value;
                const tags = form.querySelector('.productTags').value
                    .split(',')
                    .map(tag => tag.trim())
                    .filter(tag => tag);
                const isMain = form.querySelector('.productIsMain').checked;

                products.push({
                    id,
                    name,
                    price,
                    weight,
                    image,
                    link,
                    tags,
                    isMain
                });
            });

            const jsonData = {
                id: parseInt(document.getElementById('storeId').value) || 6,
                name: document.getElementById('storeName').value || "Ozon",
                logo: document.getElementById('logo').value,
                image: document.getElementById('storeImage').value,
                favorites: [
                    {
                        products: products
                    }
                ]
            };

            document.getElementById('jsonOutput').value = JSON.stringify(jsonData, null, 2);
        }

        function copyJSON() {
            const jsonOutput = document.getElementById('jsonOutput');
            jsonOutput.select();
            document.execCommand('copy');
            alert('–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!');
        }

        window.onload = function() {
            addProduct();
        };
    </script>
</body>
</html>
